"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.jsonSchemaPropertyRequired = jsonSchemaPropertyRequired;
exports.jsonSchemaValueRequired = jsonSchemaValueRequired;

var _findInfoForProperty = _interopRequireDefault(require("./findInfoForProperty"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var toArray = function toArray(obj) {
  return Array.isArray(obj) ? obj : [obj];
};

function jsonSchemaPropertyRequired(propertyName, schema) {
  var info = (0, _findInfoForProperty["default"])(propertyName, schema);
  return info && info.required || [];
}

function jsonSchemaValueRequired(propertyName, schema) {
  var info = (0, _findInfoForProperty["default"])(propertyName, schema);
  var maybeRequired = jsonSchemaPropertyRequired(propertyName, schema);
  return maybeRequired.filter(function (property) {
    var propertySchema = propertyName === 'relationships' ? info.properties[property].properties.data : info.properties[property];

    if (propertySchema.anyOf) {
      var isNullAllowed = propertySchema.anyOf.some(function (def) {
        return toArray(def.type).includes('null');
      });
      return !isNullAllowed;
    }

    return !toArray(propertySchema.type).includes('null');
  });
}