"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = _default;

var _readline = _interopRequireDefault(require("readline"));

var _fs = _interopRequireDefault(require("fs"));

var _denodeify = _interopRequireDefault(require("denodeify"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var fsAppendFile = (0, _denodeify["default"])(_fs["default"].appendFile);

function _default() {
  return new Promise(function (resolve, reject) {
    process.stdout.write('Site token is not specified! Please paste your DatoCMS site read-only API token.\n');

    var rl = _readline["default"].createInterface({
      input: process.stdin,
      output: process.stdout
    });

    rl.on('SIGINT', function () {
      process.exit(1);
    });
    rl.on('SIGCONT', function () {
      rl.prompt();
    });
    rl.question('> ', function (token) {
      rl.close();

      if (token) {
        resolve(token);
        return;
      }

      reject();
    });
  }).then(function (token) {
    return fsAppendFile('.env', "DATO_API_TOKEN=".concat(token)).then(function () {
      return process.stdout.write('\nToken added to .env file.\n\n');
    }).then(function () {
      return token;
    });
  })["catch"](function () {
    process.stderr.write('\nMissing token.\n');
    process.exit(1);
  });
}